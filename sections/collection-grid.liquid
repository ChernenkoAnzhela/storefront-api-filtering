{% assign productListString = canonical_url | remove: shop.secure_url | remove_first: '/search?q=' %}
{% assign productListArray = productListString | split: '+' %}

<div class="container main-collection-grid-wrapper">
  {%- for handle in productListArray -%}
    <a href="{{- all_products[handle].url -}}" class="item-card">
      {%- render 'card-product', product: all_products[handle] -%}
    </a>
  {%- endfor -%}
</div>

{% schema %}
{
  "name": "Collection grid",
  "class": "main-collection-grid"
}
{% endschema %}
